<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-runner-behavior.html">

<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<dom-module id="ui-page">
    <template>
        <style>
            :host {
                --iron-icon-height: 75px;
                --iron-icon-width: 75px;
            }

            #page {
                min-height: 100vh;
                width: 100%;
                position: absolute;
                top: 0;
                left: 0;
                z-index: 6;
            }
            #placeholder {
                background-color: #999;
            }

            iron-icon {
                position: absolute;
                top: 1vh;
                left: 1vw;
                color: black;
                z-index: 7;
            }
        </style>
        
        <div id="page" hidden$="{{!opened}}">
            <iron-icon icon="close" on-tap="close"></iron-icon>
            <div id="placeholder" class="fit"></div>
            <div id="container">
                <content></content>
            </div>
        </div>

    </template>
    <script>
        'use strict';
        Polymer({
            is: 'ui-page',

            behaviors: [
                Polymer.NeonAnimationRunnerBehavior
            ],

            properties: {
                opened: {
                    type: Boolean,
                    value: false
                },

                animating: {
                    type: Boolean,
                    value: false
                },

                animationConfig: {
                    value: function() {
                        return {
                            'entry': {
                                name: 'scale-up-animation',
                                node: this.$.page
                            },
                            'exit': {
                                name: 'fade-out-animation',
                                node: this.$.page
                            }
                        };
                    }
                }
            },

            listeners: {
                'neon-animation-finish': '_onNeonAnimationFinish'
            },
            
            show: function() {
                if(this.animating === false) {
                    this.animating = true;
                    this.opened = true;
                    this.playAnimation('entry', 'entry');
                }
            },

            close: function() {
                if(this.animating === false) {
                    this.animating = true;
                    this.playAnimation('exit', 'exit');
                }
            },

            _onNeonAnimationFinish: function(e, animation) {
                if(animation === 'exit' && this.opened === true) {
                    this.opened = false;
                }
                this.animating = false;
            }
        });
    </script>
</dom-module>